#!/bin/bash -e

# 
# This script generates controllers, services and models.
#
# OPTIONS
# -c        Generates a controller.
# -m        Generates a model
# -s        Generates a service.        
#

entryPoint="./utils/generate.ts"
dependenciesFolder="./deps.ts"
controller=false
model=false
service=false
help=false
controllersPath="./controllers";
modelsPath="./models";
servicesPath="./services";

while getopts cmsh flag
do
  case "${flag}" in
      c) controller=true;;
      m) model=true;;
      s) service=true;;
      h) help=true;;
  esac
done

if "$help" || [ -z "$2" ] || [ $controller == "false" ] && [ $service == "false" ] && [ $model == "false" ]; then
    echo ""
    echo "This script generates controllers, services and models."
    echo "Pass an option and a name for the component."
    echo ""
    echo "OPTIONS: "
    echo "-c    Generates a controller."
    echo "-m    Generates a model."
    echo "-s    Generates a service."
    echo ""
    exit
fi

if "$controller" && [ ! -z "$2" ]; then
    deno run --allow-write --no-check $entryPoint controller $2 $controllersPath
fi

if "$model" && [ ! -z "$2" ]; then
    deno run --allow-write --no-check $entryPoint model $2 $modelsPath
fi

if "$service" && [ ! -z "$2" ]; then
    deno run --allow-write --no-check $entryPoint service $2 $servicesPath
fi